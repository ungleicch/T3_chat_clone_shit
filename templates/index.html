<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Local AI Chat</title>
    <!-- Dependencies for Markdown and Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div id="app-container">
        <!-- =================================================================
        SIDEBAR FOR CHAT HISTORY
        ================================================================== -->
        <aside id="sidebar">
            <div class="sidebar-header">
                <button id="new-chat-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" width="1em" height="1em"><path fill="currentColor" d="M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32V224H48c-17.7 0-32 14.3-32 32s14.3 32 32 32H192V432c0 17.7 14.3 32 32 32s32-14.3 32-32V288H400c17.7 0 32-14.3 32-32s-14.3-32-32-32H256V80z"/></svg>
                    New Chat
                </button>
            </div>
            <div class="search-container">
                <label for="search-threads-input" class="search-icon-label" aria-label="Search threads">
                    <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="1em" height="1em"><path fill="currentColor" d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"/></svg>
                </label>
                <input type="text" id="search-threads-input" placeholder="Search threads...">
            </div>
            <nav id="chat-list-nav" aria-label="Chat History">
                <ul id="chat-list">
                    <!-- Chat list items will be injected here by JavaScript -->
                </ul>
            </nav>
        </aside>

        <!-- =================================================================
        MAIN CHAT AREA
        ================================================================== -->
        <main id="main-content">
            <div id="chat-window">
                <!-- Welcome screen or messages will be injected here -->
            </div>
            
            <!-- In index.html -->

            <footer id="input-area">
                <form id="chat-form" aria-label="Chat Input Form">
                    <div id="file-preview-area">
                        <!-- File previews will be injected here by JavaScript -->
                    </div>
                    
                    <div class="input-area-main">
                        <div id="main-model-selector-container" class="model-selector-container">
                            <!-- JS will inject the model avatar button here -->
                        </div>
                        
                        <div class="input-form-container">
                            <textarea id="prompt-input" placeholder="Type your message here..." rows="1" aria-label="Message Input"></textarea>
                            
                            <!-- THE FIX: Both buttons now share a container for easy swapping -->
                            <div class="send-button-container">
                                <button type="submit" id="send-btn" title="Send" aria-label="Send Message">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="1em" height="1em"><path fill="currentColor" d="M16.1 260.2c-22.6 12.9-20.5 47.3 3.6 57.3L160 376V479.3c0 18.1 14.6 32.7 32.7 32.7c9.7 0 18.9-4.3 25.1-11.8l62-74.3 123.9 51.6c18.9 7.9 40.8-4.5 43.9-24.7l64-416c1.9-12.1-7.6-22.6-19.5-22.6H16.1z"/></svg>
                                </button>
                                <button type="button" id="stop-generating-btn" class="hidden" title="Stop Generating" aria-label="Stop Generating">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" width="1em" height="1em"><path fill="currentColor" d="M0 128C0 92.7 28.7 64 64 64H320c35.3 0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V128z"/></svg>
                                </button>
                            </div>
                        </div>

                        <button type="button" id="attach-file-btn" class="input-action-btn" title="Attach File">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" width="1em" height="1em"><path fill="currentColor" d="M364.2 83.8c-24.4-24.4-64-24.4-88.4 0l-184 184c-42.1 42.1-42.1 110.3 0 152.4s110.3 42.1 152.4 0l152-152c10.9-10.9 28.7-10.9 39.6 0s10.9 28.7 0 39.6l-152 152c-64.4 64.4-169 64.4-233.4 0s-64.4-169 0-233.4l184-184c46.7-46.7 122.5-46.7 169.2 0s46.7 122.5 0 169.2l-128 128c-10.9 10.9-28.7 10.9-39.6 0s-10.9-28.7 0-39.6l128-128c24.4-24.4 24.4-64 0-88.4z"/></svg>
                        </button>
                    </div>

                    <!-- THE FIX: Footer is now outside the main input container for easy centering -->
                    <div class="input-footer">
                         <p>Powered by local Ollama models.</p>
                    </div>
                </form>
                <input type="file" id="file-input" multiple hidden>
            </footer>
        </main>
    </div>

    <!-- JavaScript Dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>